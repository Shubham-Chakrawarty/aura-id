// CORE IDENTITY: The "Passport"
enum UserStatus {
  ACTIVE
  INACTIVE
  PENDING_VERIFICATION
  SUSPENDED
}

model User {
  id           String  @id @default(cuid())
  email        String  @unique
  passwordHash String  @map("password_hash")
  firstName    String  @map("first_name")
  lastName     String  @map("last_name")
  avatarUrl    String? @map("avatar_url")

  // Status & Security
  status          UserStatus @default(PENDING_VERIFICATION)
  isEmailVerified Boolean    @default(false) @map("is_email_verified")
  blockedUntil    DateTime?  @map("blocked_until")
  lastLoginAt     DateTime?  @map("last_login_at")

  // Extensibility
  metadata Json @default("{}")

  // Lifecycle
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  deletedAt DateTime? @map("deleted_at")

  // Relations
  sessions           Session[]
  refreshTokens      RefreshToken[]
  memberships        ApplicationMembership[]
  verificationTokens VerificationToken[]

  @@map("users")
}
