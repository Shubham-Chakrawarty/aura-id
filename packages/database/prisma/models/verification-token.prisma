// 4. AUTHENTICATION TRACEABILITY
model VerificationToken {
  id         String   @id @default(cuid())

  // 1. Context: What is this token for?
  // Examples: "EMAIL_VERIFICATION", "PASSWORD_RESET", "MFA_SETUP"
  type       String

  // 2. The Secret: The actual unguessable string sent to the user
  token      String   @unique

  // 3. The Target: Who is this for?
  identifier String   // e.g., the email address
  userId     String?  // Optional: direct link to the user record

  // 4. Security & Lifecycle
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  usedAt     DateTime?

  // Relations
  user       User?    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([identifier, token])
  @@index([token])
  @@map("verification_tokens")
}